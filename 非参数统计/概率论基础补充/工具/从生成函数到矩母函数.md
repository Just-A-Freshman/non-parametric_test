## 1. 生成函数

#### 总括
我想，生成函数应该是抽象代数中的内容。它本质上将逻辑中的运算和算术运算实现了对应。正是由于两种运算的同构关系，我们才能通过代数计算来进行逻辑解释。

#### 原理回顾
- 加法原理：如果完成一件事情有M种方式，每种方式下有不同的方法，那么完成这件事情的不同方法数等于各类方法数之和。 
- 乘法原理：如果完成一件事情需要分几步走，而每一步都有不同的选择，那么完成这件事情的不同方法数等于各步方法数的乘积。
实际上，这正蕴含着生成函数的核心思想。在计数问题上，逻辑上的选择和算术上的加法对应；逻辑上的分步骤和算术上的乘法对应。

#### 问题引入
考虑这样一个集合：\(\{1, 2, 3, 4, 5\}\)。
问题1：集合的子集有多少个？
问题2：元素和为8的子集个数？

问题1：对于集合中的每一个元素，依据加法原理，它们都有\((1 + 1)\)种选择；依据乘法原理，分5步选取这些元素，故选取元素的方法一共：
\[(1 + 1)\times(1 + 1)\times(1 + 1)\times(1 + 1)\times(1 + 1) = 2^5\]

问题2：这实际上是一个更小的计数问题。在问题1中，每个元素选与不选都会为**总计数**贡献1；但现在，我们并不关心总计数，而是关心**元素和**的计数。例如：当我们选择了1和2后，我们希望某个符号表示**元素和为3**，且它的计数加1。
然而，选择1和2涉及到了分步骤选取，对应乘法原理。而**元素和**是加法。我们需要将乘法运算转化成加法运算，而指数运算的法则恰好满足这点。

让我们来将上面的式子进行改造，用\(x^0 = 1\)代表未选择元素(因为不会为**元素和**的计数做贡献)，用\(x^a\)代表选择了元素a；当分步骤选择了\(x^a\)和\(x^b\)后，\(x^{a + b}\)表示元素和为\((a + b)\)的记号, 并且计数加1了：
\[(1 + x)(1 + x^2)(1 + x^3)(1 + x^4)(1 + x^5)\]

展开这个多项式，里面\(x^8\)的系数就代表了问题2的答案。

#### 简单小结
生成函数其实就是形如一个幂级数，写作：
\[G(x) = a_0 + a_1x + a_2x^2 + a_3x^3 + ...\]
其中，\(x\)其实就是一个计数符号。而它前面的系数就是计数的结果。生成函数巧妙地将计数问题和代数问题结合了起来。而且最重要的是，生成函数包含了所有元素和的计数结果，这也是它被称为"生成"函数的原因。

----------------------

## 2、概率生成函数(PGF)
#### 动机：编码概率分布
生成函数蕴含了所有元素和的计数结果。那么我们能否用一个生成函数包含一个离散分布的所有概率分布列的结果呢？让我们用\(P(x = k)\)来替代生成函数中的\(a_k\)，就得到了：
\[G(x) = P(X = 0) + P(X = 1)x + P(X = 2)x^2 + ...\]
用求和符号简化一下：
\[G(x) = \sum_{k=0}^\infty P(X = k)x^k\]

不难看出，这其实是\(E(x^X)\)。求导可得：
备注：极限与微分的交换性不是必然满足的，即\(E'(g(x))\)并非总是等于\(E(g'(x))\)
\[E'(x^X) = E(X \cdot x^{X - 1})\]
令\(x = 1\)，我们发现：
\[E'(x^X) |_{x=0} = E(X)\]
进一步，我们求二阶导：
\[E''(x^X) = E(X(X-1) \cdot x^{X - 2})\]
令\(x = 1\)，我们发现：
\[E''(x^X) |_{x=1} = E(X(X-1)) = E(X^2) - E(X)\]
恰好满足：
\[E''(x^X) |_{x=1} + E'(x^X)|_{x=1} = E(X^2)\]
那么是否存在\(E(X^n) = E^{(k)}(x^X) |_{x=1} + E^{(k-1)}(x^X) |_{x=1}\)呢？
答案是否定的。尽管：\(x(x-1) + x = x^2\)
但显然：\(x(x-1)(x-2) + x(x-1) = x(x-1)^2 \neq x^3\)
而且观察\(x(x-1)^2\)，里面不仅包含一次项，还有二次项！因此，此时想求三阶矩，还需要一阶矩和二阶矩的结果。往更高阶矩只会更复杂。


#### 应用
让我们尝试用生成函数计算一下矩。
考虑 $X \sim \text{Poisson}(\lambda)$：
$$P(X=k) = \frac{\lambda^k e^{-\lambda}}{k!}$$

概率生成函数：
\[\begin{aligned}
P_X(x) &= \sum_{k=0}^\infty \frac{\lambda^k e^{-\lambda}}{k!} x^k = e^{-\lambda} \sum_{k=0}^\infty \frac{(\lambda x)^k}{k!}  \\ &= e^{-\lambda} \cdot e^{\lambda x} = e^{\lambda(x-1)}
\end{aligned}\]
求一阶导：\(P_X'(x) = \lambda e^{\lambda (x - 1)}\), 令\(x = 1 \implies E(X) = \lambda\)
求二阶导：\(P_X''(x) = \lambda^2e^{\lambda(x-1)}\)，令\(x=1 \\ \implies E(X^2) - E(X) = \lambda^2 \implies E(X^2) = \lambda^2 + \lambda\)
于是：\(D(X) = E(X^2) - E(X)^2 = \lambda\)
对于更高阶矩，求解难度就显著加大了。但总体上还是比用积分求法要简单。

----------------------

## 3. 矩母函数
#### 诞生
观察原生成函数：
\[G(X) = E(x^X)\]
是否能将\(x\)替换成某个函数，能使\(E^{(k)}(g(x)^X) = E(X^k)\)呢？
让我们试一下，先求一阶导：
\[E'(g(x)^X) = E(X \cdot g(x)^{X-1} \cdot g'(x))\]
要令其等于\(E(X)\)，需要满足当\(x = t\)时：
\[g(t)^{X-1} \cdot g'(t) = 1\]
注意，\(X\)是随机变量。我们显然无法将\(X\)直接消掉，因此，我们只能让\(g(t) = 1\)，这样\(g(t)^{X-1}\)恒为1。同时，\(g'(t) = 1\)
继续求导，式子会变得格外复杂。我们只能尝试用一些满足上述条件的函数进行替换。神奇的是, 当我们将\(g(x) = e^x\)以及\(t = 0\)代入上述式子，我们发现完美符合需求！(关于这里为什么代入的是e^t，我觉得应该还有更多依据或者数学思想蕴含其中。而且，这个替换是否唯一呢？也没有证明，需要完善)

#### 定义
让我们将上面的\(x \to t\)，于是原本的\(G(X) = E(e^{xX})\)就变成了\(G(X) = E(e^{tX})\)。再用\(M_X(t)\)替换原来的\(G(X)\)，就成了我们今天看到的矩母函数：
\[M_X(t) = E(e^{tX})\]

#### 性质
\[\begin{equation}M_X^{(k)}(0) = E(X^k)\end{equation}\]
\[\begin{equation} X \stackrel{d}{\sim} Y, \, M_{X+Y}(t) = M_X(t) \cdot M_Y(t)\end{equation}\]

证明：
利用\(e^x\)积分和极限计算可交换的性质：
\[M_X^{(k)}(t) = E^{(k)}(e^{tX}) = E(X^k \cdot e^{tX})\]令\(t = 0\)即可得到(1)

当\(X\)和\(Y\)独立时:
我们熟知：\(Cov(X, Y) = E(XY) - E(X) \cdot E(Y) = 0\)
因此，\(E(XY) = E(X) \cdot E(Y)\)
\[\begin{aligned}
M_{X+Y(t)} &= E(e^{t(X+Y)}) = E(e^{tX} \cdot e^{tY}) \\ 
&= E(e^{tX}) \cdot E(e^{tY}) = M_X(t) + M_Y(t)
\end{aligned}\]



