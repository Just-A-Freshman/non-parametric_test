# 超几何分布

## 一、定义
在总样本量为\(N\)，不合格品数为\(M\)的总体中进行不放回抽样\(n\)次。抽中不合格品的数量\(X\)构成的分布叫超几何分布，记作：
\[X \sim h(n, N, M)\]
ps: 类似二项分布，把实验次数记作\(n\), 概率\(p\)由\(N / M\)构成。

## 二、性质
#### 概率分布列
先从\(M\)件不合格品中抽\(k\)件，再从\(N - M\)件合格品中抽\(n - k\)件：
\[P(X = k) = \frac{\binom{M}{k} \binom{N - M}{n - k}}{\binom{N}{n}}\]

其中，\(k \in \{0, 1, 2, ..., min(M, n)\}\). 记\(U = min(M, n)\)
因为是概率分布列，自然满足正则性：
\[\sum_{k=0}^{U} P(X = k) = 1\]
这导向了一个奇妙的组合数性质：
\[\sum_{k=0}^{U}\binom{M}{k} \cdot \binom{N - M}{n - k} = \binom{N}{n}\]



#### 期望
\[E(X) = np = n \frac{N}{M}\]

#### 方差
\[\begin{aligned}
D(X) &= np(1 - p) \cdot \frac{N - n}{N - 1} \\
&= n \cdot \frac{M}{N} \cdot \frac{N - M}{N} \cdot \frac{N - n}{N - 1} \\
&= n \cdot \frac{M(N - M)(N - n)}{N^2(N - 1)}
\end{aligned}\]

ps: 如何记忆修正系数\(\frac{N-n}{N-1}\)？
①当\(n = 1\)时，即一次实验。不放回和放回的方差一样，因为没有第二次实验可以被影响。这就记住了一个\((N - 1)\)和\((N - n)\)
②数据越抽越少，数据的变异性变小，方差也变小。因此修正系数应该\(\leq 1\)。因为\(N - n \leq N - 1\)，因此\(N - n\)应该在分子的位置。于是修正系数就是：\(\frac{N - n}{N - 1}\)